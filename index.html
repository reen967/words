<!DOCTYPE html>
<html>
<head>
    <title>UARL Robot Lab</title>
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: #eee; padding: 20px; }
        .card { background: #2a2a2a; padding: 15px; border-radius: 8px; margin-bottom: 10px; }
        .output-bar { height: 20px; background: #444; width: 100%; border-radius: 10px; overflow: hidden; }
        .fill { height: 100%; background: #00ffcc; transition: width 0.1s; }
        .log { font-family: monospace; font-size: 12px; color: #00ffcc; }
    </style>
</head>
<body>
    <h1>UARL: Create a Robot</h1>
    
    <div class="card">
        <h3>1. Hardware Setup</h3>
        <button onclick="addOrb()">Add Glowing Orb (Light)</button>
        <button onclick="addBox()">Add Delivery Box (Motor)</button>
        <div id="robot-status">No Capabilities Added</div>
    </div>

    <div class="card">
        <h3>2. The Sentence</h3>
        From: <b>Alive/Ready</b> [Verb: <b>Glide</b>] To: <b>Thinking</b>
        <br><br>
        <button onclick="runSentence()">Execute Sentence</button>
    </div>

    <div class="card">
        <h3>3. Real-Time Human Antenna Loads</h3>
        <div id="display"></div>
    </div>

    <script type="module">
        import { Robot, RobotCapability } from './robot.js';
        import { SensoryKernel } from './uarl.js';

        let myRobot = new Robot("TestBot");
        let kernel = new SensoryKernel(myRobot);

        window.addOrb = () => {
            myRobot.addCapability(new RobotCapability("Main LED", "BRIGHTNESS", 0.05, 1.0));
            document.getElementById('robot-status').innerText = myRobot.getSummary();
        };

        window.addBox = () => {
            myRobot.addCapability(new RobotCapability("Vibration Motor", "VIBRATION", 0.15, 0.85));
            document.getElementById('robot-status').innerText = myRobot.getSummary();
        };

        window.runSentence = () => {
            let t = 0;
            const interval = setInterval(() => {
                t += 0.02;
                if (t > 1) clearInterval(interval);

                const results = kernel.calculateState({
                    startNoun: "ALIVE_READY",
                    verb: "GLIDE",
                    endNoun: "THINKING"
                }, t);

                render(results, t);
            }, 50);
        };

        function render(results, t) {
            const container = document.getElementById('display');
            container.innerHTML = `Time: ${t.toFixed(2)}<br>`;
            results.forEach(res => {
                container.innerHTML += `
                    <div>
                        ${res.capability} (${res.antennaTarget}): ${res.intensityPerc}% effort
                        <div class="output-bar"><div class="fill" style="width: ${res.intensityPerc}%"></div></div>
                    </div><br>`;
            });
        }
    </script>
</body>
</html>
