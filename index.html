<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robot Language: Sentence Generator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: sans-serif; background: #121212; color: #e0e0e0; padding: 20px; }
        .container { max-width: 900px; margin: auto; background: #1e1e1e; padding: 20px; border-radius: 8px; }
        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        select, input { padding: 10px; background: #333; color: white; border: 1px solid #444; border-radius: 4px; }
        canvas { background: #000; border-radius: 4px; }
        h1 { color: #00ffcc; text-align: center; }
        .label { margin-bottom: 5px; font-weight: bold; font-size: 0.9em; color: #aaa; }
    </style>
</head>
<body>

<div class="container">
    <h1>Robot Sentence Engine</h1>
    
    <div class="controls">
        <div>
            <div class="label">Start Noun</div>
            <select id="startNoun"></select>
        </div>
        <div>
            <div class="label">End Noun</div>
            <select id="endNoun"></select>
        </div>
        <div>
            <div class="label">Verb (Transition Curve)</div>
            <select id="verbType">
                <option value="snap">Snap (Logarithmic)</option>
                <option value="glide">Glide (Sigmoid)</option>
                <option value="surge">Surge (Exponential)</option>
            </select>
        </div>
        <div>
            <div class="label">Duration (seconds)</div>
            <input type="number" id="duration" value="2" step="0.1">
        </div>
    </div>

    <canvas id="waveChart" width="800" height="400"></canvas>
</div>

<script>
// 1. THE DICTIONARY (Russell 1980 Coordinates)
const emotionTable = [
    { word: "Happy", deg: 7.8 }, { word: "Excited", deg: 48.5 },
    { word: "Alarmed", deg: 96.5 }, { word: "Angry", deg: 119.5 },
    { word: "Distressed", deg: 151.7 }, { word: "Miserable", deg: 188.7 },
    { word: "Sad", deg: 193.3 }, { word: "Depressed", deg: 215.1 },
    { word: "Bored", deg: 237.9 }, { word: "Sleepy", deg: 271.9 },
    { word: "Calm", deg: 294.1 }, { word: "Relaxed", deg: 310.2 },
    { word: "Content", deg: 341.2 }, { word: "Serene", deg: 348.5 }
];

// Populate Dropdowns
const startSelect = document.getElementById('startNoun');
const endSelect = document.getElementById('endNoun');

emotionTable.forEach(e => {
    let opt1 = new Option(e.word, e.deg);
    let opt2 = new Option(e.word, e.deg);
    startSelect.add(opt1);
    endSelect.add(opt2);
});
startSelect.value = "294.1"; // Default Calm
endSelect.value = "96.5";   // Default Alarmed

// 2. THE VERB EQUATIONS
const verbs = {
    snap: (t) => 1 - Math.pow(1 - t, 4),
    glide: (t) => 3 * Math.pow(t, 2) - 2 * Math.pow(t, 3),
    surge: (t) => Math.pow(t, 4)
};

// 3. CHARTING SETUP
const ctx = document.getElementById('waveChart').getContext('2d');
let waveChart = new Chart(ctx, {
    type: 'line',
    data: { labels: [], datasets: [{ label: 'Robot Output (Arousal)', data: [], borderColor: '#00ffcc', borderWidth: 2, pointRadius: 0 }] },
    options: { scales: { y: { min: -1.5, max: 1.5 }, x: { title: { display: true, text: 'Time (s)' } } } }
});

function calculateWave() {
    const startDeg = parseFloat(startSelect.value);
    const endDeg = parseFloat(endSelect.value);
    const duration = parseFloat(document.getElementById('duration').value);
    const verb = document.getElementById('verbType').value;
    
    const timeStep = 0.05;
    const totalTime = 5.0; // Total window
    const transitionStart = 1.0;
    
    let labels = [];
    let data = [];

    // Shortest path logic
    let diff = (endDeg - startDeg + 180) % 360 - 180;

    for (let t = 0; t <= totalTime; t += timeStep) {
        let u = 0;
        if (t > transitionStart) {
            let tNorm = Math.min(1, (t - transitionStart) / duration);
            u = verbs[verb](tNorm);
        }

        let currentDeg = startDeg + (diff * u);
        let currentRad = currentDeg * (Math.PI / 180);
        
        // 4. THE NOUN (Oscillation)
        let x = Math.cos(currentRad); // Valence
        let y = Math.sin(currentRad); // Arousal
        
        let oscillation = 0;
        if (x > 0) {
            oscillation = 0.1 * Math.sin(t * 15); // Smooth
        } else {
            oscillation = 0.15 * (Math.random() - 0.5); // Jagged
        }

        labels.push(t.toFixed(2));
        data.push(y + oscillation);
    }

    waveChart.data.labels = labels;
    waveChart.data.datasets[0].data = data;
    waveChart.update();
}

[startSelect, endSelect, document.getElementById('verbType'), document.getElementById('duration')].forEach(el => {
    el.addEventListener('change', calculateWave);
});

calculateWave();
</script>
</body>
</html>
